@{
    Layout = "_Layout";
}
@using TextRpg.Models;

<div class="roomName">
  <h3>CryoChamber A</h3>
</div>

@* //Introduction Event -------------------------------------------------------------- *@

<div class="event introduction">
  <p>You open your eyes to see the glass in front of you slowly receding. A sudden wave of warm air overwhelms your entire body as you rack your mind to remember where you are. Your name's @Game.GetGameUser().GetCharacter().GetName(), and it's the year 2025. You've been sent with approximately 500 others on humanity's first attempt to colonize Mars. Beyond the confines of your own cryochamber, you see a large open expanse surrounded with approximately 100 other chambers. The room is fairly dark. If it weren't for the softly-glowing red light in the middle of the ceiling, you wouldn't be able to see anything.

  You take in a deep breath, expecting the clean, slightly chemical smell all-too-familiar to anyone who's ever spent much time on a space vessel--or in a hospital. Instead, you notice something stronger. It reminds you of the last day you spent on Earth before embarking on this journey, nearly six months ago. Your family and friends surprised you with a barbecue. You can smell the smoldering coals from the grill ... or is that the smell of the bonfire you sat around with your significant other that evening planning all the things you would do together after you return? What you would give for a swig of that whiskey you two shared that night ...

  Urged forward by the warmth of the outside air and the smell of home, you slowly peel off the sensors adhered to your chest  and step out of the chamber.

  Around the room you see cryochambers, a computer terminal, an equipment locker, and--at the far-side of the room--two doors which presumably lead out of it.</p>

  <div class="routes">
    <button class="route route1" type="button">Check out the other cryochambers in the room</button>
    <button class="route route2" type="button">Check out the terminal in the middle of the CryoChamber Room</button>
    <button class="route route3" type="button">Check out the equipment locker</button>
    <button class="route route4" type="button">Walk towards the doors</button>
  </div>
</div>

 @* Event 1 --------------------------------------------------------------------- *@

<div class="event initHidden" id="event1">
  <p>You walk up to the nearest cryochamber off to your left. The glass is foggy. A placard at the bottom of the machine reads Elizabeth Dougherty. You remember her. Back at the academy, she graduated top of her class--which just so happened to also be yours. Though you never really liked her--she wasn't very approachable, to say the least--you could always depend on her to be able to solve the toughest of problems. There seemed to be no predicament that she couldn't reason her way out of.

  You place  your hand up against the glass to wipe away a patch of fog. Then you step up closer to peer through. Behind the glass you see only the soft, synthetic fabric used to cushion the interior and the dangling wires attached to the many sensors used to track the colonists' vitals as they remain in a state of suspended animation for the duration of the flight. Startled, you take a step back and look around the room again.
 </p>

 <div class="routes">
   <button class="route route2" type="button">Check out the terminal in the middle of the CryoChamber Room</button>
   <button class="route route3" type="button">Check out the equipment locker</button>
   <button class="route route4" type="button">Walk towards the doors</button>
 </div>

</div>

@* Event 2 --------------------------------------------------------------------- *@

<div class="event initHidden" id="event2">
  <p>You approach the terminal in the middle of the room. A single displayed line reads: "currently running emergency protocol". Below, are a list of options: <p>

    <div class="options">
      <button class="option option1">Click on [View Ship Vitals]</button>
      <button class="option option2">Click on [View Captains Log]</button>
      <button class="option option3">Click on [Remotely Access AirLock]</button>
    </div>

    <div class="subevent subevent1 initHidden">

    </div>

    <div class="subevent subevent2 initHidden">

    </div>

    <div class="subevent subevent3 initHidden">

    </div>

    <div class="routes">
      <button class="route route1" type="button">Check out the other cryochambers in the room</button>
      <button class="route route3" type="button">Check out the equipment locker</button>
      <button class="route route4" type="button">Walk towards the doors</button>
    </div>
</div>

@* Event 3 -------------------------------------------------------------------------- *@

<div class="event initHidden" id="event3">
  <p> Your equipment locker is at the far left-hand side of the room. Despite the modernity of all the technology available to SpaceX, they opted to secure each locker with a physical key. You recall having a discussion with your officer about funding cuts... You feel around in your pocket hoping to find your own key, but it's not there. Before backing away, you notice a locker near yours that is slightly ajar.

    <div class="options">
      <button class="option option1" type="button">Try to force the locker open</button>
      <button class="option option2" type="button">Walk away</button>
    </div>

    <div class="subevent subevent1 initHidden">
      <button class="suboption suboption1" type="button">Pick up crowbar</button>
      <button class="suboption suboption2" type="button">Pick up armor</button>
    </div>

    <div class="routes main">
      <button class="route route1" type="button">Check out the other cryochambers in the room</button>
      <button class="route route3" type="button">Check out the equipment locker</button>
      <button class="route route4" type="button">Walk towards the doors</button>
    </div>
</div>

@* Event 4 ---------------------------------------------------------------------- *@

<div class="event initHidden" id="event4">
  <p> There are two doors leading out of the cryochamber room. The first room is clearly marked with a warning that reads, "AIR LOCK: ONLY OPEN REMOTELY IN ACCORDANCE WITH EMERGENCY PROTOCOL 150". There is a sign above the second door that reads, "This way to CANTINA and MEDICAL BAY". </p>

  <div class="options">
    <button class="option option1" type="button">Approach the AIR LOCK</button>
    <button class="option option2" type="button">Approach door to CANTINA and MEDICAL BAY</button>
  </div>


  <div class="subevent subevent1 initHidden">
    <p> As you approach the AIR LOCK, you hear the soft hissing sound of a small air leak. Looking around the door, there appears to be no easy way of opening the AIR LOCK. This is probably for the best.</p>

    <div class="suboptions">
      <button class="suboption suboption1" type="button">Attempt to open AIR LOCK with crowbar.</button>
      <button class="suboption suboption2" type="button">Back away from AIR LOCK.</button>
    </div>
  </div>

  <div class="subevent subevent2 initHidden">
    <p> Beyond this door is a series of hallways that lead to the ship's cafeteria you and colonists are planning on using for your first several months on Mars and the ship's medical bay. You notice that as you stand near the door, the smell of smoke has grown stronger and noticeably less pleasant. It suddenly strikes you how out-of-place this smell is on a space vessel, and you begin to feel an overwhelming sense of discomfort. Something is definitely not right.

    <div class="suboptions">
      <button class="suboption suboption1" type="button">Back away from door</button>
      <a href="/Room/2"><button class="exit suboption suboption2" type="button">Continue through the door into the hallway</button></a>
    </div>
  </div>
</div>

@* Begin scripting for this page --------------------------------------------------- *@

<script type="text/javascript">

  $(document).ready(function() {

    var updateGameLog = function(gameLogMessage) {
      $.ajax({
        url: "/GameConsole/Append",
        type: "POST",
        data: {message: gameLogMessage},
        success: function(data){
          console.log("success");
          $("#gameConsole").html(data);
          console.log(data);
        }
      });
    };

    var inventoryAddItem = function(itemIndex){
      $.ajax({
        url: "/Inventory/AddItem",
        type: "POST",
        data: {index: itemIndex},
        success: function(data){
          console.log(data);
          console.log("item added: " + data._name);
          console.log(data["name"]);
          console.log(data[0]);
          $("#equippableInventory .col-md-12 .row").append('<div class="col-md-3 itemCard"><p class="itemName">' + data._name + '</p><img class="itemImage" src="' + data._imgUrl + '"/></div>')
        }
      })
    }

    $(".initHidden").addClass("hidden");

    $(".route1").click(function() {
      $(this).parent().parent().addClass("hidden");
      $("#event1").removeClass("hidden");
    });

    $(".route2").click(function() {
      $(this).parent().parent().addClass("hidden");
      $("#event2").removeClass("hidden");
    });

    $(".route3").click(function() {
      $(this).parent().parent().addClass("hidden");
      $("#event3").removeClass("hidden");
    });

    $(".route4").click(function() {
      $(this).parent().parent().addClass("hidden");
      $("#event4").removeClass("hidden");
    });

    $("#event2 .option1").click(function() {
      updateGameLog("<ul>Ship Vitals<li>Oxygen: 7%</li><li>Fuel: 10%</li><li>Main Power Status: Inactive</li><li>Auxillary Power Status: Active</li></ul>");
    });

    $("#event2 .option2").click(function() {
      updateGameLog("<p>You do not have access to the Captain's Log</p>");
    });

    $("#event2 .option3").click(function() {
      updateGameLog("<p>You do not have the authority to remotely access the airlock</p>");
    });

    $("#event3 .option1").click(function() {
      updateGameLog("<p>You kick the locker several times, breaking a toe in the process. Your effort pays off, however. You successfully open the locker. After searching through its contents, you find a few items that may be useful, including a crowbar and a set of basic, protective armor");
      $(this).parent().parent().find(".subevent1").removeClass("hidden");
      $(this).remove();
    });

    $("#event3 .subevent1 .suboption1").click(function() {
      updateGameLog("<p>A crowbar has been added to your inventory. Click on the crowbar in your inventory to equip it.</p>");
      updateGameLog();
      inventoryAddItem(10);
      $(this).remove();
    });

    $("#event3 .subevent1 #suboption2").click(function() {
      updateGameLog("<p>A set of basic armor has been added to your inventory. Click on the individual armor items in your inventory to equip them.</p>");
      inventoryAddItem(11);
      inventoryAddItem(12);
      inventoryAddItem(13);
      inventoryAddItem(14);
      inventoryAddItem(15);
      $(this).remove();
    });

    $("#event4 .option1").click(function() {
      $(this).parent().addClass("hidden");
      $("#event4 .subevent1").removeClass("hidden");
    })

    $("#event4 .subevent1 .suboption1").click(function() {
      updateGameLog("<p>As you place the edge of the crowbar against the small opening between the AIR LOCK doors you can't help but think back to your family. The told you at the academy that the trip to Mars would be difficult, but you never anticipated the psychological impact being this significant. You throw your weight against the crowbar, but nothing happens. You reposition the crowbar and lean hard against the handle again. This time, you feel the door give away under your weight, and the airlock flies open. The next few seconds are a deluge of loud whooshing and intense physical sensations that could not possibly be communicated to anyone else. You feel a tremendous force push your body through the AIR LOCK. Before blacking out, you turn your head around to see the SpaceX colonial vessel slowly shrinking behind you. The name of the ship, LAST HOPE, is painted on its side.</p>");
        // Endgame Scenario
    });

    $("#event4 .subevent1 .suboptions .suboption2").click(function() {
      $(this).parent().parent().parent().find(".options").removeClass("hidden");
      $(this).parent().parent().addClass("hidden");
    });

    $("#event4 .option2").click(function() {
      $(this).parent().addClass("hidden");
      $("#event4 .subevent2").removeClass("hidden");
    });

    $("#event4 .subevent2 .suboptions .suboption1").click(function() {
      $(this).parent().parent().parent().find(".options").removeClass("hidden");
      $(this).parent().parent().addClass("hidden");
    });
  });

</script>
